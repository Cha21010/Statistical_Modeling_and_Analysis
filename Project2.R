Dat <- read.csv('/Users/ronghaozeng/Desktop/Project 2 Student Data Files/069152_project2.csv', header = TRUE)
M_E <- lm(Y ~ E1+E2+E3+E4, data=Dat)
summary(M_E)
M_raw <- lm(Y ~ (E1+E2+E3+E4+G1+G2+G3+G4+G5+G6+G7+G8+G9+G10+G11+G12+G13+G14+G15+G16+G17+G18+G19+G20)^2, data=Dat)
plot(resid(M_raw) ~ fitted(M_raw), main='Residual Plot')
library(MASS)
boxcox(M_raw)
M_trans <- lm( I(Y^1.1) ~ (E1+E2+E3+E4+G1+G2+G3+G4+G5+G6+G7+G8+G9+G10+G11+G12+G13+G14+G15+G16+G17+G18+G19+G20)^2, data=Dat )
plot(resid(M_trans) ~ fitted(M_trans), main='New Residual Plot')
summary(M_raw)$adj.r.square
summary(M_trans)$adj.r.square
install.packages("leaps")
library(leaps)
M <- regsubsets( model.matrix(M_trans)[,-1], I((Dat$Y)^1.1),nbest = 1 , nvmax=5, method = 'forward', intercept = TRUE )
temp <- summary(M)
install.packages("knitr")
library(knitr)
Var <- colnames(model.matrix(M_trans))
 M_select <- apply(temp$which, 1,function(x) paste0(Var[x], collapse='+'))
 kable(data.frame(cbind( model = M_select, adjR2 = temp$adjr2, BIC = temp$bic)),caption='Model Summary')
 M_main <- lm( I(Y^1.1) ~ E1+E2+E3+E4+G1+G2+G3+G4+G5+G6+G7+G8+G9+G10+G11+G12+G13+G14+G15+G16+G17+G18+G19+G20, data=Dat)
 temp <- summary(M_main)
kable(temp$coefficients[ abs(temp$coefficients[,4]) <= 0.001, ], caption='Sig Coefficients')
M_2stage <- lm( I(Y^1.1) ~ (E1+E3+G8+G19)^2, data=Dat)
temp <- summary(M_2stage)
kable(temp$coefficients[ abs(temp$coefficients[,3]) >= 4, ])
M_final <- lm(I(Y^1.1) ~ E1 + E3 + G8:G19, data = Dat)
summary(M_final)
